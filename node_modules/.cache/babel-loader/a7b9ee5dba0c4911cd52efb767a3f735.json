{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nimport React from \"react\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query getProducts($ids: [ID!]!) {\\n    nodes(ids: $ids) {\\n      ... on Product {\\n        title\\n        handle\\n        description\\n        id\\n        totalVariants\\n        images(first: 1) {\\n          edges {\\n            node {\\n              originalSrc\\n              altText\\n            }\\n          }\\n        }\\n        variants(first: 10) {\\n          edges {\\n            node {\\n              price\\n              id\\n              image {\\n                originalSrc\\n                altText\\n              }\\n              displayName\\n              compareAtPrice\\n            }\\n          }\\n        }\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport gql from 'graphql-tag';\nimport { Button, Card, Checkbox, EmptyState, Form, FormLayout, Heading, Layout, Page, ResourceList, Select, Stack, Subheading, TextField, Thumbnail } from '@shopify/polaris';\nimport { Context } from \"@shopify/app-bridge-react\";\nimport { Redirect } from \"@shopify/app-bridge/actions\";\nimport store from \"store-js\";\nimport { Query } from \"react-apollo\";\nimport Modal from \"@shopify/app-bridge-react/components/Modal\";\nimport ResourceListWithProducts from \"./ResourceList\"; //TODO: fetch all variants, not first 10\n\nvar GET_PRODUCT_BY_ID = gql(_templateObject());\n\nvar CreateTestVariant =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CreateTestVariant, _React$Component);\n\n  function CreateTestVariant() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CreateTestVariant);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CreateTestVariant)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      productSelected: 'product',\n      variantSelected: 0,\n      productTitle: '',\n      productDescription: '',\n      variantTitle: '',\n      variantPrice: '',\n      variantDiscount: ''\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"redirect\", function () {\n      _this.props.variantCreated(false);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"itemToBeConsumed\", function () {\n      var item = store.get('item');\n      var price = item.variants.edges[0].node.price;\n      var variantId = item.variants.edges[0].node.id;\n      var discounter = price * 0.1;\n\n      _this.setState({\n        price: price,\n        variantId: variantId\n      });\n\n      return (price - discounter).toFixed(2);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTextChange\", function (value) {\n      _this.setState({\n        value: value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleProductOrVariantSelectChange\", function (newValue) {\n      _this.setState({\n        productSelected: newValue\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleVariantSelectChange\", function (newValue, variantsArray) {\n      console.log(\"VARIANTS ARRAY:\", variantsArray);\n\n      _this.setState({\n        variantSelected: newValue,\n        variantTitle: variantsArray.nodes[0].variants.edges[newValue].displayName,\n        variantPrice: variantsArray[newValue].node.price,\n        variantDiscount: variantsArray[newValue].node.compareAtPrice\n      });\n\n      console.log(_this.state);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleProductSubmit\", function () {});\n\n    _defineProperty(_assertThisInitialized(_this), \"handleVariantSubmit\", function () {});\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSave\", function () {});\n\n    return _this;\n  }\n\n  _createClass(CreateTestVariant, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var productOrVariantSelectOptions = [{\n        label: 'Product',\n        value: 'product'\n      }, {\n        label: 'Variants',\n        value: 'variants'\n      }];\n      var app = this.context;\n      return React.createElement(Query, {\n        query: GET_PRODUCT_BY_ID,\n        variables: {\n          ids: store.get('ids')\n        }\n      }, function (_ref) {\n        var data = _ref.data,\n            loading = _ref.loading,\n            error = _ref.error;\n\n        if (loading) {\n          return React.createElement(\"div\", null, \"Loading\\u2026\");\n        }\n\n        if (error) {\n          return React.createElement(\"div\", null, error.message);\n        }\n\n        var variantsArray = data.nodes[0].variants.edges;\n        var variantSelectOptions = [];\n        variantsArray.forEach(function (variant, index) {\n          variantSelectOptions.push({\n            label: variant.node.displayName,\n            value: index\n          });\n        });\n        console.log(data);\n        return React.createElement(Page, {\n          primaryAction: {\n            content: 'Create A/B Test',\n            onAction: function onAction() {\n              return _this2.handleSave;\n            }\n          }\n        }, React.createElement(Select, {\n          label: \"Create test for:\",\n          disabled: false,\n          options: productOrVariantSelectOptions,\n          onChange: _this2.handleProductOrVariantSelectChange,\n          value: _this2.state.productSelected\n        }), _this2.state.productSelected === 'product' ? React.createElement(Form, {\n          onSubmit: _this2.handleProductSubmit\n        }, React.createElement(FormLayout, null, React.createElement(Thumbnail, {\n          source: data.nodes[0].images.edges[0] ? data.nodes[0].images.edges[0].node.originalSrc : '',\n          alt: data.nodes[0].images.edges[0] ? data.nodes[0].images.edges[0].node.altText : ''\n        }), React.createElement(TextField, {\n          readOnly: false,\n          value: _this2.state.productTitle //value={data.nodes[0].title}\n          ,\n          onChange: _this2.handleTextChange,\n          label: \"Product Name\",\n          type: \"text\"\n        }))) : React.createElement(Form, {\n          onSubmit: _this2.handleVariantSubmit\n        }, React.createElement(FormLayout, null, React.createElement(Select, {\n          label: \"Select product variant to create test for:\",\n          disabled: false,\n          options: variantSelectOptions,\n          onChange: _this2.handleVariantSelectChange.bind(_this2, variantsArray, data),\n          value: data.nodes[0].variants.edges[_this2.state.variantSelected].node.displayName\n        }), React.createElement(Thumbnail, {\n          source: data.nodes[0].variants.edges[_this2.state.variantSelected].node.image ? data.nodes[0].variants.edges[_this2.state.variantSelected].node.image.originalSrc : data.nodes[0].images.edges[0].node.originalSrc,\n          alt: data.nodes[0].variants.edges[_this2.state.variantSelected].node.image ? data.nodes[0].variants.edges[_this2.state.variantSelected].node.image.altText : data.nodes[0].images.edges[0].node.altText\n        }), React.createElement(TextField, {\n          readOnly: false,\n          value: data.nodes[0].variants.edges[_this2.state.variantSelected].node.displayName,\n          onChange: _this2.handleTextChange,\n          label: \"Product Name\",\n          type: \"text\"\n        }), React.createElement(TextField, {\n          readOnly: false,\n          value: data.nodes[0].variants.edges[_this2.state.variantSelected].node.price,\n          onChange: _this2.handleTextChange,\n          label: \"Original Price\",\n          type: \"text\"\n        }), React.createElement(TextField, {\n          readOnly: false,\n          value: data.nodes[0].variants.edges[_this2.state.variantSelected].node.compareAtPrice,\n          onChange: _this2.handleTextChange,\n          label: \"Discounted Price\",\n          type: \"text\"\n        }))));\n      });\n    }\n  }]);\n\n  return CreateTestVariant;\n}(React.Component);\n\n_defineProperty(CreateTestVariant, \"contextType\", Context);\n\nexport default CreateTestVariant;","map":{"version":3,"sources":["C:\\Users\\Oliver\\Shopify\\Seamless AB Testing\\components\\CreateTestVariant.js"],"names":["gql","Button","Card","Checkbox","EmptyState","Form","FormLayout","Heading","Layout","Page","ResourceList","Select","Stack","Subheading","TextField","Thumbnail","Context","Redirect","store","Query","Modal","ResourceListWithProducts","GET_PRODUCT_BY_ID","CreateTestVariant","productSelected","variantSelected","productTitle","productDescription","variantTitle","variantPrice","variantDiscount","props","variantCreated","item","get","price","variants","edges","node","variantId","id","discounter","setState","toFixed","value","newValue","variantsArray","console","log","nodes","displayName","compareAtPrice","state","productOrVariantSelectOptions","label","app","context","ids","data","loading","error","message","variantSelectOptions","forEach","variant","index","push","content","onAction","handleSave","handleProductOrVariantSelectChange","handleProductSubmit","images","originalSrc","altText","handleTextChange","handleVariantSubmit","handleVariantSelectChange","bind","image","React","Component"],"mappings":"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","sourcesContent":["import gql from 'graphql-tag';\r\nimport { Button, Card, Checkbox, EmptyState, Form, FormLayout, Heading, Layout, Page, ResourceList, Select, Stack, Subheading, TextField, Thumbnail } from '@shopify/polaris';\r\nimport {Context} from \"@shopify/app-bridge-react\";\r\nimport {Redirect} from \"@shopify/app-bridge/actions\";\r\nimport store from \"store-js\";\r\nimport {Query} from \"react-apollo\";\r\nimport Modal from \"@shopify/app-bridge-react/components/Modal\";\r\nimport ResourceListWithProducts from \"./ResourceList\";\r\n\r\n//TODO: fetch all variants, not first 10\r\nconst GET_PRODUCT_BY_ID = gql`\r\n  query getProducts($ids: [ID!]!) {\r\n    nodes(ids: $ids) {\r\n      ... on Product {\r\n        title\r\n        handle\r\n        description\r\n        id\r\n        totalVariants\r\n        images(first: 1) {\r\n          edges {\r\n            node {\r\n              originalSrc\r\n              altText\r\n            }\r\n          }\r\n        }\r\n        variants(first: 10) {\r\n          edges {\r\n            node {\r\n              price\r\n              id\r\n              image {\r\n                originalSrc\r\n                altText\r\n              }\r\n              displayName\r\n              compareAtPrice\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nclass CreateTestVariant extends React.Component {\r\n    static contextType = Context;\r\n    state = {\r\n        productSelected: 'product',\r\n        variantSelected: 0,\r\n        productTitle: '',\r\n        productDescription: '',\r\n        variantTitle: '',\r\n        variantPrice: '',\r\n        variantDiscount: ''\r\n    };\r\n\r\n    render() {\r\n        const productOrVariantSelectOptions = [{ label: 'Product', value: 'product' }, { label: 'Variants', value: 'variants' }];\r\n\r\n        const app = this.context;\r\n\r\n        return (\r\n            <Query query={GET_PRODUCT_BY_ID} variables={{ ids: store.get('ids') }}>\r\n                {({ data, loading, error }) => {\r\n                    if (loading) { return <div>Loadingâ€¦</div>; }\r\n                    if (error) { return <div>{error.message}</div>; }\r\n                    const variantsArray = data.nodes[0].variants.edges;\r\n                    const variantSelectOptions = [];\r\n                    variantsArray.forEach(function(variant, index) {\r\n                        variantSelectOptions.push({label: variant.node.displayName, value: index})\r\n                    });\r\n\r\n                    console.log(data);\r\n                    return(\r\n                        <Page\r\n                            primaryAction={{\r\n                                content: 'Create A/B Test',\r\n                                onAction: () => this.handleSave,\r\n                            }}\r\n                            >\r\n                                <Select\r\n                                    label=\"Create test for:\"\r\n                                    disabled={false}\r\n                                    options={productOrVariantSelectOptions}\r\n                                    onChange={this.handleProductOrVariantSelectChange}\r\n                                    value={this.state.productSelected}/>\r\n\r\n                            {this.state.productSelected === 'product' ? (\r\n                                <Form onSubmit={this.handleProductSubmit}>\r\n                                    <FormLayout>\r\n                                        <Thumbnail\r\n                                            source={\r\n                                                data.nodes[0].images.edges[0]\r\n                                                    ? data.nodes[0].images.edges[0].node.originalSrc\r\n                                                    : ''\r\n                                            }\r\n                                            alt={\r\n                                                data.nodes[0].images.edges[0]\r\n                                                    ? data.nodes[0].images.edges[0].node.altText\r\n                                                    : ''\r\n                                            }\r\n                                        />\r\n                                        <TextField\r\n                                            readOnly={false}\r\n                                            value={this.state.productTitle}\r\n                                            //value={data.nodes[0].title}\r\n                                            onChange={this.handleTextChange}\r\n                                            label=\"Product Name\"\r\n                                            type=\"text\"\r\n                                        />\r\n                                    </FormLayout>\r\n                                </Form>\r\n\r\n                            ) : (\r\n                                <Form onSubmit={this.handleVariantSubmit}>\r\n                                    <FormLayout>\r\n                                        <Select\r\n                                            label=\"Select product variant to create test for:\"\r\n                                            disabled={false}\r\n                                            options={variantSelectOptions}\r\n                                            onChange={this.handleVariantSelectChange.bind(this, variantsArray, data)}\r\n                                            value={data.nodes[0].variants.edges[this.state.variantSelected].node.displayName}/>\r\n                                        <Thumbnail\r\n                                            source={\r\n                                                data.nodes[0].variants.edges[this.state.variantSelected].node.image\r\n                                                    ? data.nodes[0].variants.edges[this.state.variantSelected].node.image.originalSrc\r\n                                                    : data.nodes[0].images.edges[0].node.originalSrc\r\n                                            }\r\n                                            alt={\r\n                                                data.nodes[0].variants.edges[this.state.variantSelected].node.image\r\n                                                    ? data.nodes[0].variants.edges[this.state.variantSelected].node.image.altText\r\n                                                    : data.nodes[0].images.edges[0].node.altText\r\n                                            }\r\n                                        />\r\n                                        <TextField\r\n                                            readOnly={false}\r\n                                            value={data.nodes[0].variants.edges[this.state.variantSelected].node.displayName}\r\n                                            onChange={this.handleTextChange}\r\n                                            label=\"Product Name\"\r\n                                            type=\"text\"\r\n                                        />\r\n\r\n                                        <TextField\r\n                                            readOnly={false}\r\n                                            value={data.nodes[0].variants.edges[this.state.variantSelected].node.price}\r\n                                            onChange={this.handleTextChange}\r\n                                            label=\"Original Price\"\r\n                                            type=\"text\"\r\n                                        />\r\n\r\n                                        <TextField\r\n                                            readOnly={false}\r\n                                            value={data.nodes[0].variants.edges[this.state.variantSelected].node.compareAtPrice}\r\n                                            onChange={this.handleTextChange}\r\n                                            label=\"Discounted Price\"\r\n                                            type=\"text\"\r\n                                        />\r\n                                    </FormLayout>\r\n                                </Form>\r\n                                )}\r\n                        </Page>\r\n                    )\r\n                }}\r\n                    </Query>\r\n        );\r\n    }\r\n\r\n    redirect = () => {\r\n        this.props.variantCreated(false)\r\n    };\r\n\r\n    itemToBeConsumed = () => {\r\n        const item = store.get('item');\r\n        const price = item.variants.edges[0].node.price;\r\n        const variantId = item.variants.edges[0].node.id;\r\n        const discounter = price * 0.1;\r\n        this.setState({ price, variantId });\r\n        return (price - discounter).toFixed(2);\r\n    };\r\n\r\n    handleTextChange = (value) => {\r\n        this.setState({ value });\r\n    };\r\n\r\n    handleProductOrVariantSelectChange = newValue => {\r\n        this.setState({ productSelected: newValue });\r\n    };\r\n\r\n    handleVariantSelectChange = (newValue, variantsArray) => {\r\n        console.log(\"VARIANTS ARRAY:\", variantsArray);\r\n\r\n        this.setState({\r\n            variantSelected: newValue,\r\n            variantTitle: variantsArray.nodes[0].variants.edges[newValue].displayName,\r\n            variantPrice: variantsArray[newValue].node.price,\r\n            variantDiscount: variantsArray[newValue].node.compareAtPrice });\r\n\r\n        console.log(this.state);\r\n    };\r\n\r\n    handleProductSubmit = () => {\r\n\r\n    };\r\n\r\n    handleVariantSubmit = () => {\r\n\r\n    };\r\n\r\n    handleSave = () => {\r\n\r\n    }\r\n}\r\n\r\nexport default CreateTestVariant;"]},"metadata":{},"sourceType":"module"}